Lab Report 

**Assignment on Malware** 

By 

Ridwanul Haque 1705111 

**Task 1:** 

How I turned the FooVirus into a worm by incorporating networking code in it- 

- Using get\_new\_usernames(), get\_new\_passwds(), get\_fresh\_ipaddresses() functions from AbraWorm.py to access other networks/machines. 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.001.jpeg)


- Establishing connections with the Target Host  

  (this block is almost similar to the one used in AbraWorm.py) 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.002.jpeg)

- Added new String “fooVirus” that contains the FooVirus code to be executed.

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.003.jpeg)

- Added a new function ***write\_foo\_to\_file(filename***) that writes the FooVirus code in a new file (Line 147)
- I have created a new file **FooVirus.py** that contains the FooVirus code:

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.004.png)

- Deploy this file on the target Host (Line 150-151) 
- Run this file on the target Host (Line 154) 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.005.jpeg)

- Connect to other Host (Line 177) 
- Deploy the FooVirus file (Line 180) 
- Execute the FooVirus (Line 181) 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.006.jpeg)

- Close the connection (Line 182) 
- Remove the temporary “FooVirus.py” file from main Machine.(Line 183) 

**Task 2:** 

How I modified the AbraWorm.py so that no two copies of the worm are exactly the same in all of the infected hosts: 

- Adding a new function ***get\_random\_variation()*** 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.007.jpeg)


This function can add operations to- 

- Put random comments in a random block of code 
- Import other Library 
- Print “Hello World!” in random position of the code- block 
- Print 1-10 or 1-99 numbers  
- Assign new Variables 
- Add new function foo() that returns “bar” 
- Add new function that returns nothing 
- Print numbers using List Comprehension Method 
- Print Custom Variations 

**This changes will be added in the new AbraWorm.py code sent over the network.** 

- Store the content of the main **AbraWorm.py** to a variable. 
- Apply Random Variation 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.008.jpeg)

- When Applying variation, **I made sure that random operations are added in between the new-lines or Blank lines of the code so that the overall function of the main AbraWorm.py does not change.** 
- Split the content into lines (Line 133) 
- Find Indices of lines that are empty (Line 136) 
- Choose a random index from the list of empty line indices (Line 139-143) 
- Insert random variations (Line 146) 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.009.png)

- Write the modified content to a temporary File (Line 150-152) 
- Process the extension so that the modified AbraWorm.py has the same file name as before (Line 154) 
- Deploy the modified Script with same name (Line 156) 
- Close the connection (line 157) 

**Task 3:** 

How I extended the code so that it descends down the directory structure and examines the files at the entry level: 

- Use **‘grep -rl abracadabra \*’**  to iterate through all subdirectories. 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.010.png)

- Get the absolute path of the file on local machine (Line 158)
- Get the name of the file without the directory path (Line 162)
- Send the file over the network (Line 165)

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.011.png)

- Done! 


**Before Executing Task 1:** Machine 1 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.012.png)

Machine 2 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.013.png)

**After Executing Task 1:** Machine 1 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.014.png)

Machine 2 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.015.jpeg)

**Before Executing Task 2:** 

Machine 2 and 1 Respectively- 

![ref1]

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.017.png)

Machine 1 and 2 Respectively-

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.018.jpeg)

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.019.jpeg)

**Before Executing Task 3:** 

Machine 1 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.020.png)

Machine 2 

![ref2]

Run the file 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.022.jpeg)

***Machine 1 has been infected with the Worm (modified)*** 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.023.png)


***Machine 2 receives malicious files from Machine 1:*** 

![](Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.024.png)

Thank You 

[ref1]: Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.016.png
[ref2]: Aspose.Words.02005afd-ecdc-490f-8680-82d3649bbfd6.021.png
